:tocdepth: 1

.. sectnum::

.. Metadata such as the title, authors, and description are set in metadata.yaml

.. TODO: Delete the note below before merging new content to the main branch.

.. note::

   **This technote is a work-in-progress.**

Abstract
========

Describes the means of serving the desired DP0.3 data through the services of the Rubin Science Platform.  Initially will serve as a proposal and then evolve into an as-built description.

Motivation and Overview
=======================

Ticket `PREOPS-1152`_ and an in-progress revision of `RTN-011`_ envision the creation of a new entry in the "DP0" (simulated and/or precursor data) series of Data Previews: service of an existing catalog-based "fast simulation" of the expected Solar System data from the LSST survey, not tied to image data and not the output of the main Science Pipelines.

This "DP0.3" would provide some exposure to the Rubin Science Platform (RSP) and the planned Solar System data model to Data Previews delegates, and allow the early testing of certain features of the RSP that are specific to Solar System (or, more precisely, moving-object) data.
As presently discussed, this Data Preview would be made available to users in mid-2023.

The fast simulation, generated by the Solar System Science Collaboration (SSSC), represents the results of the full ten-year baseline LSST survey.
Four catalog tables involved with Solar System science and the Rubin moving-object pipeline would be served as part of DP0.3:
``DIASource``, ``SSSource``, ``SSObject``, and ``MPCORB``.
The first two tables will each have approximately one billion rows each, and the last two will have approximately ten million rows each.

The proposed exercise has some notable limitations compared to the final expected environment for Solar System data:

- As the data are the result of a "fast simulation" without imaging, none of the capabilities of the RSP dealing with imaging data would be exercised.
  For the most part this is not a concern, since DP0.2 has been exercising those capabilities, but there is at least one relevant special case:
  
  - It is planned to provide for time-series queries on moving objects in the RSP that appear together with appropriate cutouts
    in the images on which the points in the time series were observed.
    This would not be possible in DP0.3.
  - More generally, the usual linkages from single-epoch measurements in catalog tables (in this case, ``DIASource`` and ``SSSource``)
    to the associated images would not be available.

- As the result of a static simulation, rather than a progressive nightly release through the PPDB as we will have in Operations,
  DP0.3 would not exercise certain dynamic aspects of the data model, such as the transformation from DIAObject to SSObject when
  sufficient data are accumulated to allow identification of a previous DIAObject as arising from an SSO.
  It would therefore also not exercise the ability of users of the RSP to follow and/or replay that evolution.


.. _PREOPS-1152: https://jira.lsstcorp.org/browse/PREOPS-1152
.. _RTN-011: https://rtn-011.lsst.io/

Input Data
==========

The simulation itself is described at https://github.com/lsst-sssc/lsst-simulation .
It produces the following tables, all of which have reference definitions in the `DPDD`_:

.. _table-ssotables:

.. table:: Major tables to be included in a Solar System DP0.3

   +-----------+--------------------------------------------------+--------------+-------------------+---------------------+
   | Table     | Purpose                                          | Size in rows | Number of columns | Data volume on disk |
   |           |                                                  |              | (in/not in DPDD)  | (in XXX format)     |
   +===========+==================================================+==============+===================+=====================+
   | DIASource | Observation in a single difference image         |              |                   |                     |
   +-----------+--------------------------------------------------+--------------+-------------------+---------------------+
   | SSSource  | Apparition of a reconstructed SSO in an image    |              |                   |                     |
   +-----------+--------------------------------------------------+--------------+-------------------+---------------------+
   | SSObject  | Reconstructed SSO with orbital parameters        |              |                   |                     |
   +-----------+--------------------------------------------------+--------------+-------------------+---------------------+
   | MPCORB    | Shadow of Minor Planet Center database           |              |                   |                     |
   +-----------+--------------------------------------------------+--------------+-------------------+---------------------+
   | (total)   |                                                  |              |                   | 0.5 - 1.0 TB        |
   +-----------+--------------------------------------------------+--------------+-------------------+---------------------+

The simulation is based on a specific, chosen OpSim run.
The actual simulation output to be used for DP0.3 is yet to be produced, but a prototype dataset exists and has been in use by the SSSC, ingested into a PostgreSQL database.

.. _DPDD: https://lse-163.lsst.io/

Service Model
=============

.. A non-Rubin all-sky HiPS image, likely from 2MASS, will be used as the default context image for display of query results in the RSP Portal Aspect.
   This is acceptable for DP0.3 because there is no simulated static sky involved that is significantly different from the real universe
   (Unlike the case for DP0.2).

Preparations Required
=====================

Database Setup
--------------

Ingest
------

Data Model Metadata
-------------------

Service Deployment
------------------

Potential New Services
^^^^^^^^^^^^^^^^^^^^^^


.. See the `reStructuredText Style Guide <https://developer.lsst.io/restructuredtext/style.html>`__ to learn how to create sections, links, images, tables, equations, and more.

.. Make in-text citations with: :cite:`bibkey`.
.. Uncomment to use citations
.. .. rubric:: References
.. 
.. .. bibliography:: local.bib lsstbib/books.bib lsstbib/lsst.bib lsstbib/lsst-dm.bib lsstbib/refs.bib lsstbib/refs_ads.bib
..    :style: lsst_aa
